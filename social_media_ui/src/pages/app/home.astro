---
import MenuBar from "../../components/app/MenuBar.astro"
import PostComment from "../../components/app/PostComment.astro"
---
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Social Page</title>
  
</head>
<body class="bg-gray-100 min-h-screen">
  <MenuBar/>
  <PostComment/>
  <!-- Floating Button -->
<div id="newPostBtn" class="fixed bottom-6 right-6 bg-blue-500 text-white p-3 rounded-full shadow-lg hover:bg-blue-600">
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="h-8 w-8">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
  </svg>
</div>
<!-- Modal for Creating New Post -->
<div
id="newPostModal"
class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center hidden"
>
<div class="bg-white rounded-lg shadow-lg w-11/12 md:w-1/2 p-6">
    <h2 class="text-xl font-bold mb-4">Create New Post</h2>
    <form id="newPostForm">
        <textarea
            id="postContent"
            class="w-full p-2 border rounded mb-4"
            rows="3"
            placeholder="What's on your mind?"></textarea>
        <!-- Hidden file input -->
        <input
            id="postImage"
            type="file"
            accept="image/*"
            class="hidden"
        />
        <!-- Custom file button -->
        <label
            for="postImage"
            class="cursor-pointer bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition duration-300 text-center inline-block mb-4"
        >
            Choose Image
        </label>
        <!-- Image preview -->
        <div id="imagePreview" class="mb-4"></div>
        <div class="flex justify-end">
            <button
                type="button"
                id="cancelPost"
                class="bg-gray-200 text-gray-800 px-4 py-2 rounded hover:bg-gray-300 transition duration-300 mr-2"
                >Cancel</button
            >
            <button
                type="submit"
                class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition duration-300"
                >Post</button
            >
        </div>
    </form>
</div>
</div>

<script>
  // Get elements
  const postImageInput = document.getElementById("postImage");
  const imagePreview = document.getElementById("imagePreview");

  // Listen for file selection
  postImageInput.addEventListener("change", (event) => {
      // Clear previous preview
      imagePreview.innerHTML = "";

      // Get selected file
      const file = event.target.files[0];

      // Check if file is an image
      if (file && file.type.startsWith("image/")) {
          // Create a FileReader to read the image
          const reader = new FileReader();
          reader.onload = (e) => {
              // Create an img element
              const img = document.createElement("img");
              img.src = e.target.result;
              img.alt = "Selected Image";
              img.className = "w-full h-0 object-cover rounded";
              // Append the image to the preview container
              imagePreview.appendChild(img);
          };
          reader.readAsDataURL(file); // Read the image file
      } else {
          // Show an error message if the file is not an image
          const errorMessage = document.createElement("p");
          errorMessage.textContent = "Please select a valid image file.";
          errorMessage.className = "text-red-500";
          imagePreview.appendChild(errorMessage);
      }
  });
</script>

<script>
      // Modal for creating new post
      const newPostModal = document.getElementById('newPostModal');
    const newPostBtn = document.getElementById('newPostBtn');
    const cancelPost = document.getElementById('cancelPost');
    const newPostForm = document.getElementById('newPostForm');

    newPostBtn.addEventListener('click', () => {
      newPostModal.classList.remove('hidden');
    });

    cancelPost.addEventListener('click', () => {
      newPostModal.classList.add('hidden');
    });

    newPostForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const content = document.getElementById('postContent').value;
      const image = document.getElementById('postImage').value;

      if (content.trim()) {
        const newPost = {
          id: posts.length + 1,
          author: "You",
          avatar: "https://i.pravatar.cc/40?img=3",
          time: "Just now",
          content,
          image: image || null,
          comments: []
        };
        posts.unshift(newPost);
        renderPosts();
        newPostModal.classList.add('hidden');
      }
    });
</script>
</body>
</html>